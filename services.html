<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø®Ø¯Ù…Ø©</title>
  <style>
    body {
      font-family: 'Cairo', sans-serif;
      background-color: #000;
      color: #0f0;
      padding: 20px;
    }
    .section {
      border: 2px solid #0f0;
      padding: 15px;
      margin: 20px 0;
      border-radius: 15px;
      background: #111;
    }
    select, input, button {
      width: 100%;
      padding: 10px;
      margin: 10px 0;
      border-radius: 8px;
      border: 1px solid #0f0;
      background: #111;
      color: #0f0;
    }
    button {
      background: #0f0;
      color: #000;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h2>Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø³Ù… ÙˆØ§Ù„Ø®Ø¯Ù…Ø©</h2>

  <div class="section">
    <label for="categorySelect">Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø³Ù…:</label>
    <select id="categorySelect" onchange="loadServices()"></select>

    <label for="serviceSelect">Ø§Ø®ØªØ± Ø§Ù„Ø®Ø¯Ù…Ø©:</label>
    <select id="serviceSelect"></select>

    <label for="quantity">Ø§Ù„ÙƒÙ…ÙŠØ©:</label>
    <input type="number" id="quantity" min="1" placeholder="Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨">

    <button onclick="placeOrder()">Ø§Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù†</button>
  </div>

  <script>
    const telegramToken = '7903542020:AAG-Kv90O7Un3E_G8VdYsyYG19SW9B2_ttY';
    const telegramChatId = '8047097446';

    const categories = JSON.parse(localStorage.getItem('categories')) || [];
    const services = JSON.parse(localStorage.getItem('services')) || [];

    const categorySelect = document.getElementById('categorySelect');
    const serviceSelect = document.getElementById('serviceSelect');

    function loadCategories() {
      categorySelect.innerHTML = '';
      categories.forEach(cat => {
        const option = document.createElement('option');
        option.value = cat.name;
        option.textContent = cat.name;
        categorySelect.appendChild(option);
      });
      loadServices();
    }

    function loadServices() {
      const selectedCategory = categorySelect.value;
      const filteredServices = services.filter(s => s.category === selectedCategory);
      serviceSelect.innerHTML = '';
      filteredServices.forEach(s => {
        const option = document.createElement('option');
        option.value = JSON.stringify(s);
        option.textContent = `${s.name} - ${s.price} Ø¬Ù†ÙŠÙ‡`;
        serviceSelect.appendChild(option);
      });
    }

    function placeOrder() {
      const selectedService = JSON.parse(serviceSelect.value);
      const quantity = document.getElementById('quantity').value;
      const client = JSON.parse(localStorage.getItem('currentClient'));

      if (!quantity || quantity < 1) return alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©');

      const message = `\nðŸ”” Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯:\nðŸ‘¤ Ø§Ù„Ø¹Ù…ÙŠÙ„: ${client.username}\nðŸ“± Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ: ${client.phone}\nðŸ“¦ Ø§Ù„Ø®Ø¯Ù…Ø©: ${selectedService.name}\nðŸ§© Ø§Ù„Ù‚Ø³Ù…: ${selectedService.category}\nðŸ“Œ Ø§Ù„ÙƒÙ…ÙŠØ©: ${quantity}\nðŸ’° Ø§Ù„Ø³Ø¹Ø±: ${selectedService.price} Ø¬Ù†ÙŠÙ‡`;

      fetch(`https://api.telegram.org/bot${telegramToken}/sendMessage`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ chat_id: telegramChatId, text: message })
      });

      alert('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­');
    }

    loadCategories();
  </script>
</body>
</html>
